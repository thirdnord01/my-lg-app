((self||this)["webpackJsonp@sprinklr/chat-web-client"]=(self||this)["webpackJsonp@sprinklr/chat-web-client"]||[]).push([[79],{1061:function(t,e,r){"use strict";(function(e){var n=r(751),o=r(561).Readable,i={objectMode:!0},s={clean:!0},c=r(1507);function u(t){if(!(this instanceof u))return new u(t);this.options=t||{},this.options=n(s,t),this._inflights=new c}u.prototype.put=function(t,e){return this._inflights.set(t.messageId,t),e&&e(),this},u.prototype.createStream=function(){var t=new o(i),r=!1,n=[],s=0;return this._inflights.forEach((function(t,e){n.push(t)})),t._read=function(){!r&&s<n.length?this.push(n[s++]):this.push(null)},t.destroy=function(){if(!r){var t=this;r=!0,e.nextTick((function(){t.emit("close")}))}},t},u.prototype.del=function(t,e){return(t=this._inflights.get(t.messageId))?(this._inflights.delete(t.messageId),e(null,t)):e&&e(new Error("missing packet")),this},u.prototype.get=function(t,e){return(t=this._inflights.get(t.messageId))?e(null,t):e&&e(new Error("missing packet")),this},u.prototype.close=function(t){this.options.clean&&(this._inflights=null),t&&t()},t.exports=u}).call(this,r(417))},1067:function(t,e,r){"use strict";var n=r(562);t.exports=function(){return n(this).length=0,this}},1068:function(t,e,r){"use strict";var n=r(1515),o=Math.max;t.exports=function(t){return o(0,n(t))}},1069:function(t,e,r){"use strict";var n=Object.create,o=Object.getPrototypeOf,i={};t.exports=function(){var t=Object.setPrototypeOf,e=arguments[0]||n;return"function"===typeof t&&o(t(e(null),i))===i}},1070:function(t,e,r){"use strict";var n,o=r(1519),i=r(562),s=Object.prototype.isPrototypeOf,c=Object.defineProperty,u={configurable:!0,enumerable:!1,writable:!0,value:void 0};n=function(t,e){if(i(t),null===e||o(e))return t;throw new TypeError("Prototype must be null or an object")},t.exports=function(t){var e,r;return t?(2===t.level?t.set?(r=t.set,e=function(t,e){return r.call(n(t,e),e),t}):e=function(t,e){return n(t,e).__proto__=e,t}:e=function t(e,r){var o;return n(e,r),(o=s.call(t.nullPolyfill,e))&&delete t.nullPolyfill.__proto__,null===r&&(r=t.nullPolyfill),e.__proto__=r,o&&c(t.nullPolyfill,"__proto__",u),e},Object.defineProperty(e,"level",{configurable:!1,enumerable:!1,writable:!1,value:t.level})):null}(function(){var t,e=Object.create(null),r={},n=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__");if(n){try{(t=n.set).call(e,r)}catch(o){}if(Object.getPrototypeOf(e)===r)return{set:t,level:2}}return e.__proto__=r,Object.getPrototypeOf(e)===r?{level:2}:((e={}).__proto__=r,Object.getPrototypeOf(e)===r&&{level:1})}()),r(1520)},1071:function(t,e,r){"use strict";var n=r(1521),o=/^\s*class[\s{/}]/,i=Function.prototype.toString;t.exports=function(t){return!!n(t)&&!o.test(i.call(t))}},1072:function(t,e,r){"use strict";var n=r(642),o=Array.prototype.forEach,i=Object.create,s=function(t,e){var r;for(r in t)e[r]=t[r]};t.exports=function(t){var e=i(null);return o.call(arguments,(function(t){n(t)&&s(Object(t),e)})),e}},1073:function(t,e,r){"use strict";t.exports=r(1528)()?String.prototype.contains:r(1529)},1074:function(t,e,r){"use strict";var n=r(1535);t.exports=function(t){if(!n(t))throw new TypeError(t+" is not a symbol");return t}},1075:function(t,e,r){"use strict";var n=r(1539);t.exports=function(t){if(!n(t))throw new TypeError(t+" is not iterable");return t}},1076:function(t,e,r){"use strict";var n=r(643),o=r(855),i=r(1545),s=r(1546),c=function(t,e){return t.replace("%v",s(e))};t.exports=function(t,e,r){if(!o(r))throw new TypeError(c(e,t));if(!n(t)){if("default"in r)return r.default;if(r.isOptional)return null}var s=i(r.errorMessage);throw n(s)||(s=e),new TypeError(c(s,t))}},1077:function(t,e,r){(function(e){var n=r(1562),o=function(){},i=function(t,r,s){if("function"===typeof r)return i(t,null,r);r||(r={}),s=n(s||o);var c=t._writableState,u=t._readableState,a=r.readable||!1!==r.readable&&t.readable,l=r.writable||!1!==r.writable&&t.writable,p=!1,f=function(){t.writable||h()},h=function(){l=!1,a||s.call(t)},_=function(){a=!1,l||s.call(t)},d=function(e){s.call(t,e?new Error("exited with error code: "+e):null)},b=function(e){s.call(t,e)},y=function(){e.nextTick(g)},g=function(){if(!p)return(!a||u&&u.ended&&!u.destroyed)&&(!l||c&&c.ended&&!c.destroyed)?void 0:s.call(t,new Error("premature close"))},v=function(){t.req.on("finish",h)};return!function(t){return t.setHeader&&"function"===typeof t.abort}(t)?l&&!c&&(t.on("end",f),t.on("close",f)):(t.on("complete",h),t.on("abort",y),t.req?v():t.on("request",v)),function(t){return t.stdio&&Array.isArray(t.stdio)&&3===t.stdio.length}(t)&&t.on("exit",d),t.on("end",_),t.on("finish",h),!1!==r.error&&t.on("error",b),t.on("close",y),function(){p=!0,t.removeListener("complete",h),t.removeListener("abort",y),t.removeListener("request",v),t.req&&t.req.removeListener("finish",h),t.removeListener("end",f),t.removeListener("close",f),t.removeListener("finish",h),t.removeListener("exit",d),t.removeListener("end",_),t.removeListener("error",b),t.removeListener("close",y)}};t.exports=i}).call(this,r(417))},1079:function(t,e,r){"use strict";var n=r(408).Buffer,o=t.exports;for(var i in o.types={0:"reserved",1:"connect",2:"connack",3:"publish",4:"puback",5:"pubrec",6:"pubrel",7:"pubcomp",8:"subscribe",9:"suback",10:"unsubscribe",11:"unsuback",12:"pingreq",13:"pingresp",14:"disconnect",15:"reserved"},o.codes={},o.types){var s=o.types[i];o.codes[s]=i}function c(t){return[0,1,2].map((function(e){return[0,1].map((function(r){return[0,1].map((function(i){var s=new n(1);return s.writeUInt8(o.codes[t]<<o.CMD_SHIFT|(r?o.DUP_MASK:0)|e<<o.QOS_SHIFT|i,0,!0),s}))}))}))}o.CMD_SHIFT=4,o.CMD_MASK=240,o.DUP_MASK=8,o.QOS_MASK=3,o.QOS_SHIFT=1,o.RETAIN_MASK=1,o.LENGTH_MASK=127,o.LENGTH_FIN_MASK=128,o.SESSIONPRESENT_MASK=1,o.SESSIONPRESENT_HEADER=n.from([o.SESSIONPRESENT_MASK]),o.CONNACK_HEADER=n.from([o.codes.connack<<o.CMD_SHIFT]),o.USERNAME_MASK=128,o.PASSWORD_MASK=64,o.WILL_RETAIN_MASK=32,o.WILL_QOS_MASK=24,o.WILL_QOS_SHIFT=3,o.WILL_FLAG_MASK=4,o.CLEAN_SESSION_MASK=2,o.CONNECT_HEADER=n.from([o.codes.connect<<o.CMD_SHIFT]),o.PUBLISH_HEADER=c("publish"),o.SUBSCRIBE_HEADER=c("subscribe"),o.UNSUBSCRIBE_HEADER=c("unsubscribe"),o.ACKS={unsuback:c("unsuback"),puback:c("puback"),pubcomp:c("pubcomp"),pubrel:c("pubrel"),pubrec:c("pubrec")},o.SUBACK_HEADER=n.from([o.codes.suback<<o.CMD_SHIFT]),o.VERSION3=n.from([3]),o.VERSION4=n.from([4]),o.QOS=[0,1,2].map((function(t){return n.from([t])})),o.EMPTY={pingreq:n.from([o.codes.pingreq<<4,0]),pingresp:n.from([o.codes.pingresp<<4,0]),disconnect:n.from([o.codes.disconnect<<4,0])}},1080:function(t,e,r){"use strict";var n=r(1079),o=r(408).Buffer,i=o.allocUnsafe(0),s=o.from([0]),c=r(1571),u=r(683).nextTick,a=c.cache,l=c.generateNumber,p=c.generateCache,f=v,h=!0;function _(t,e){switch(e.cork&&(e.cork(),u(d,e)),h&&(h=!1,p()),t.cmd){case"connect":return function(t,e){var r=t||{},i=r.protocolId||"MQTT",s=r.protocolVersion||4,c=r.will,u=r.clean,a=r.keepalive||0,l=r.clientId||"",p=r.username,h=r.password;void 0===u&&(u=!0);var _=0;if(!i||"string"!==typeof i&&!o.isBuffer(i))return e.emit("error",new Error("Invalid protocolId")),!1;_+=i.length+2;if(3!==s&&4!==s)return e.emit("error",new Error("Invalid protocol version")),!1;_+=1;if("string"!==typeof l&&!o.isBuffer(l)||!l&&4!==s||!l&&!u){if(s<4)return e.emit("error",new Error("clientId must be supplied before 3.1.1")),!1;if(1*u===0)return e.emit("error",new Error("clientId must be given if cleanSession set to 0")),!1}else _+=l.length+2;if("number"!==typeof a||a<0||a>65535||a%1!==0)return e.emit("error",new Error("Invalid keepalive")),!1;_+=2;if(_+=1,c){if("object"!==typeof c)return e.emit("error",new Error("Invalid will")),!1;if(!c.topic||"string"!==typeof c.topic)return e.emit("error",new Error("Invalid will topic")),!1;if(_+=o.byteLength(c.topic)+2,c.payload&&c.payload){if(!(c.payload.length>=0))return e.emit("error",new Error("Invalid will payload")),!1;"string"===typeof c.payload?_+=o.byteLength(c.payload)+2:_+=c.payload.length+2}else _+=2}var d=!1;if(null!=p){if(!E(p))return e.emit("error",new Error("Invalid username")),!1;d=!0,_+=o.byteLength(p)+2}if(null!=h){if(!d)return e.emit("error",new Error("Username is required to use password")),!1;if(!E(h))return e.emit("error",new Error("Invalid password")),!1;_+=S(h)+2}e.write(n.CONNECT_HEADER),y(e,_),w(e,i),e.write(4===s?n.VERSION4:n.VERSION3);var b=0;b|=null!=p?n.USERNAME_MASK:0,b|=null!=h?n.PASSWORD_MASK:0,b|=c&&c.retain?n.WILL_RETAIN_MASK:0,b|=c&&c.qos?c.qos<<n.WILL_QOS_SHIFT:0,b|=c?n.WILL_FLAG_MASK:0,b|=u?n.CLEAN_SESSION_MASK:0,e.write(o.from([b])),f(e,a),w(e,l),c&&(g(e,c.topic),w(e,c.payload));null!=p&&w(e,p);null!=h&&w(e,h);return!0}(t,e);case"connack":return function(t,e){var r=(t||{}).returnCode;if("number"!==typeof r)return e.emit("error",new Error("Invalid return code")),!1;return e.write(n.CONNACK_HEADER),y(e,2),e.write(t.sessionPresent?n.SESSIONPRESENT_HEADER:s),e.write(o.from([r]))}(t,e);case"publish":return function(t,e){var r=t||{},s=r.qos||0,c=r.retain?n.RETAIN_MASK:0,u=r.topic,a=r.payload||i,l=r.messageId,p=0;if("string"===typeof u)p+=o.byteLength(u)+2;else{if(!o.isBuffer(u))return e.emit("error",new Error("Invalid topic")),!1;p+=u.length+2}o.isBuffer(a)?p+=a.length:p+=o.byteLength(a);if(s&&"number"!==typeof l)return e.emit("error",new Error("Invalid messageId")),!1;s&&(p+=2);e.write(n.PUBLISH_HEADER[s][t.dup?1:0][c?1:0]),y(e,p),f(e,S(u)),e.write(u),s>0&&f(e,l);return e.write(a)}(t,e);case"puback":case"pubrec":case"pubrel":case"pubcomp":case"unsuback":return function(t,e){var r=t||{},o=r.cmd||"puback",i=r.messageId,s=r.dup&&"pubrel"===o?n.DUP_MASK:0,c=0;"pubrel"===o&&(c=1);if("number"!==typeof i)return e.emit("error",new Error("Invalid messageId")),!1;return e.write(n.ACKS[o][c][s][0]),y(e,2),f(e,i)}(t,e);case"subscribe":return function(t,e){var r=t||{},i=r.dup?n.DUP_MASK:0,s=r.messageId,c=r.subscriptions,u=0;if("number"!==typeof s)return e.emit("error",new Error("Invalid messageId")),!1;u+=2;if("object"!==typeof c||!c.length)return e.emit("error",new Error("Invalid subscriptions")),!1;for(var a=0;a<c.length;a+=1){var l=c[a].topic,p=c[a].qos;if("string"!==typeof l)return e.emit("error",new Error("Invalid subscriptions - invalid topic")),!1;if("number"!==typeof p)return e.emit("error",new Error("Invalid subscriptions - invalid qos")),!1;u+=o.byteLength(l)+2+1}e.write(n.SUBSCRIBE_HEADER[1][i?1:0][0]),y(e,u),f(e,s);for(var h=!0,_=0;_<c.length;_++){var d=c[_],b=d.topic,v=d.qos;g(e,b),h=e.write(n.QOS[v])}return h}(t,e);case"suback":return function(t,e){var r=t||{},i=r.messageId,s=r.granted,c=0;if("number"!==typeof i)return e.emit("error",new Error("Invalid messageId")),!1;c+=2;if("object"!==typeof s||!s.length)return e.emit("error",new Error("Invalid qos vector")),!1;for(var u=0;u<s.length;u+=1){if("number"!==typeof s[u])return e.emit("error",new Error("Invalid qos vector")),!1;c+=1}return e.write(n.SUBACK_HEADER),y(e,c),f(e,i),e.write(o.from(s))}(t,e);case"unsubscribe":return function(t,e){var r=t||{},i=r.messageId,s=r.dup?n.DUP_MASK:0,c=r.unsubscriptions,u=0;if("number"!==typeof i)return e.emit("error",new Error("Invalid messageId")),!1;u+=2;if("object"!==typeof c||!c.length)return e.emit("error",new Error("Invalid unsubscriptions")),!1;for(var a=0;a<c.length;a+=1){if("string"!==typeof c[a])return e.emit("error",new Error("Invalid unsubscriptions")),!1;u+=o.byteLength(c[a])+2}e.write(n.UNSUBSCRIBE_HEADER[1][s?1:0][0]),y(e,u),f(e,i);for(var l=!0,p=0;p<c.length;p++)l=g(e,c[p]);return l}(t,e);case"pingreq":case"pingresp":case"disconnect":return function(t,e){return e.write(n.EMPTY[t.cmd])}(t,e);default:return e.emit("error",new Error("Unknown command")),!1}}function d(t){t.uncork()}Object.defineProperty(_,"cacheNumbers",{get:function(){return f===v},set:function(t){t?(a&&0!==Object.keys(a).length||(h=!0),f=v):(h=!1,f=m)}});var b={};function y(t,e){var r=b[e];r||(r=function(t){var e=0,r=0,n=o.allocUnsafe(function(t){return t>=0&&t<128?1:t>=128&&t<16384?2:t>=16384&&t<2097152?3:t>=2097152&&t<268435456?4:0}(t));do{e=t%128|0,(t=t/128|0)>0&&(e|=128),n.writeUInt8(e,r++)}while(t>0);return n}(e),e<16384&&(b[e]=r)),t.write(r)}function g(t,e){var r=o.byteLength(e);f(t,r),t.write(e,"utf8")}function v(t,e){return t.write(a[e])}function m(t,e){return t.write(l(e))}function w(t,e){"string"===typeof e?g(t,e):e?(f(t,e.length),t.write(e)):f(t,0)}function S(t){return t?t instanceof o?t.length:o.byteLength(t):0}function E(t){return"string"===typeof t||t instanceof o}t.exports=_},1081:function(t,e,r){"use strict";var n=r(1578);t.exports=function(t,e){var r,o;return e.port=e.port||1883,e.hostname=e.hostname||e.host||"localhost",r=e.port,o=e.hostname,n.createConnection(r,o)}},1082:function(t,e,r){"use strict";var n=!1,o=[];function i(t){n?wx.sendSocketMessage({data:t.buffer||t}):o.push(t)}var s=r(1083);function c(t,e){var r="MQIsdp"===e.protocolId&&3===e.protocolVersion?"mqttv3.1":"mqtt";!function(t){t.hostname||(t.hostname="localhost"),t.path||(t.path="/"),t.wsOptions||(t.wsOptions={})}(e);var c=function(t,e){var r="wxs"===t.protocol?"wss":"ws",n=r+"://"+t.hostname+t.path;return t.port&&80!==t.port&&443!==t.port&&(n=r+"://"+t.hostname+":"+t.port+t.path),"function"===typeof t.transformWsUrl&&(n=t.transformWsUrl(n,t,e)),n}(e,t);return s(function(t,e){var r={OPEN:1,CLOSING:2,CLOSED:3,readyState:n?1:0,send:i,close:wx.closeSocket,onopen:null,onmessage:null,onclose:null,onerror:null};return wx.connectSocket({url:t,protocols:e}),wx.onSocketOpen((function(t){r.readyState=r.OPEN,n=!0;for(var e=0;e<o.length;e++)i(o[e]);o=[],r.onopen&&r.onopen.apply(r,arguments)})),wx.onSocketMessage((function(t){r.onmessage&&r.onmessage.apply(r,arguments)})),wx.onSocketClose((function(){r.onclose&&r.onclose.apply(r,arguments),r.readyState=r.CLOSED,n=!1})),wx.onSocketError((function(){r.onerror&&r.onerror.apply(r,arguments),r.readyState=r.CLOSED,n=!1})),r}(c,[r]))}t.exports=function(t,e){if(e.hostname=e.hostname||e.host,!e.hostname)throw new Error("Could not determine host. Specify host manually.");return c(t,e)}},1083:function(t,e,r){"use strict";(function(e,n){var o=r(561).Transform,i=r(1580),s=r(1582),c=r(408).Buffer;t.exports=function(t,r,u){var a,l,p="browser"===e.title,f=!!n.WebSocket,h=p?function t(e,r,n){if(l.bufferedAmount>d)return void setTimeout(t,b,e,r,n);g&&"string"===typeof e&&(e=c.from(e,"utf8"));try{l.send(e)}catch(o){return n(o)}n()}:function(t,e,r){if(l.readyState!==l.OPEN)return void r();g&&"string"===typeof t&&(t=c.from(t,"utf8"));l.send(t,r)};r&&!Array.isArray(r)&&"object"===typeof r&&(u=r,r=null,("string"===typeof u.protocol||Array.isArray(u.protocol))&&(r=u.protocol));u||(u={});void 0===u.objectMode&&(u.objectMode=!(!0===u.binary||void 0===u.binary));var _=function(t,e,r){var n=new o({objectMode:t.objectMode});return n._write=e,n._flush=r,n}(u,h,(function(t){l.close(),t()}));u.objectMode||(_._writev=E);var d=u.browserBufferSize||524288,b=u.browserBufferTimeout||1e3;"object"===typeof t?l=t:(l=f&&p?new s(t,r):new s(t,r,u)).binaryType="arraybuffer";var y="undefined"===typeof l.addEventListener;l.readyState===l.OPEN?a=_:(a=a=i(void 0,void 0,u),u.objectMode||(a._writev=E),y?l.addEventListener("open",v):l.onopen=v);a.socket=l,y?(l.addEventListener("close",m),l.addEventListener("error",w),l.addEventListener("message",S)):(l.onclose=m,l.onerror=w,l.onmessage=S);_.on("close",(function(){l.close()}));var g=!u.objectMode;function v(){a.setReadable(_),a.setWritable(_),a.emit("connect")}function m(){a.end(),a.destroy()}function w(t){a.destroy(t)}function S(t){var e=t.data;e=e instanceof ArrayBuffer?c.from(e):c.from(e,"utf8"),_.push(e)}function E(t,e){for(var r=new Array(t.length),n=0;n<t.length;n++)"string"===typeof t[n].chunk?r[n]=c.from(t[n],"utf8"):r[n]=t[n].chunk;this._write(c.concat(r),"binary",e)}return a}}).call(this,r(417),r(125))},1084:function(t,e,r){"use strict";(function(e){var n=r(1083),o=r(563),i=["rejectUnauthorized","ca","cert","key","pfx","passphrase"],s="browser"===e.title;function c(t,e){var r="MQIsdp"===e.protocolId&&3===e.protocolVersion?"mqttv3.1":"mqtt";!function(t){t.hostname||(t.hostname="localhost"),t.port||("wss"===t.protocol?t.port=443:t.port=80),t.path||(t.path="/"),t.wsOptions||(t.wsOptions={}),s||"wss"!==t.protocol||i.forEach((function(e){t.hasOwnProperty(e)&&!t.wsOptions.hasOwnProperty(e)&&(t.wsOptions[e]=t[e])}))}(e);var o=function(t,e){var r=t.protocol+"://"+t.hostname+":"+t.port+t.path;return"function"===typeof t.transformWsUrl&&(r=t.transformWsUrl(r,t,e)),r}(e,t);return n(o,[r],e.wsOptions)}t.exports=s?function(t,e){if(e.hostname||(e.hostname=e.host),!e.hostname){if("undefined"===typeof document)throw new Error("Could not determine host. Specify host manually.");var r=o.parse(document.URL);e.hostname=r.hostname,e.port||(e.port=r.port)}return c(t,e)}:function(t,e){return c(t,e)}}).call(this,r(417))},1498:function(t,e,r){"use strict";(function(e,n){var o=r(466),i=r(1061),s=r(1077),c=r(1564),u=r(561).Writable,a=r(399),l=r(1572),p=r(1573),f=r(751),h=e.setImmediate||function(t){n.nextTick(t)},_={keepalive:60,reschedulePings:!0,protocolId:"MQTT",protocolVersion:4,reconnectPeriod:1e3,connectTimeout:3e4,clean:!0,resubscribe:!0};function d(t,e,r){t.emit("packetsend",e),!c.writeToStream(e,t.stream)&&r?t.stream.once("drain",r):r&&r()}function b(t,e,r){t.outgoingStore.put(e,(function(n){if(n)return r&&r(n);d(t,e,r)}))}function y(){}function g(t,e){var r,n=this;if(!(this instanceof g))return new g(t,e);for(r in this.options=e||{},_)"undefined"===typeof this.options[r]?this.options[r]=_[r]:this.options[r]=e[r];this.options.clientId="string"===typeof this.options.clientId?this.options.clientId:"mqttjs_"+Math.random().toString(16).substr(2,8),this.streamBuilder=t,this.outgoingStore=this.options.outgoingStore||new i,this.incomingStore=this.options.incomingStore||new i,this.queueQoSZero=void 0===this.options.queueQoSZero||this.options.queueQoSZero,this._resubscribeTopics={},this.messageIdToTopic={},this.pingTimer=null,this.connected=!1,this.disconnecting=!1,this.queue=[],this.connackTimer=null,this.reconnectTimer=null,this.nextId=Math.max(1,Math.floor(65535*Math.random())),this.outgoing={},this.on("connect",(function(){if(!this.disconnected){this.connected=!0;var t=this.outgoingStore.createStream();this.once("close",e),t.on("end",(function(){n.removeListener("close",e)})),t.on("error",(function(t){n.removeListener("close",e),n.emit("error",t)})),function e(){if(t){var r,o=t.read(1);o?n.disconnecting||n.reconnectTimer?t.destroy&&t.destroy():(r=n.outgoing[o.messageId],n.outgoing[o.messageId]=function(t,n){r&&r(t,n),e()},n._sendPacket(o)):t.once("readable",e)}}()}function e(){t.destroy(),t=null}})),this.on("close",(function(){this.connected=!1,clearTimeout(this.connackTimer)})),this.on("connect",this._setupPingTimer),this.on("connect",(function(){var t=this.queue;!function e(){var r,o=t.shift();o&&(r=o.packet,n._sendPacket(r,(function(t){o.cb&&o.cb(t),e()})))}()}));var s=!0;this.on("connect",(function(){!s&&this.options.clean&&Object.keys(this._resubscribeTopics).length>0&&(this.options.resubscribe?(this._resubscribeTopics.resubscribe=!0,this.subscribe(this._resubscribeTopics)):this._resubscribeTopics={}),s=!1})),this.on("close",(function(){null!==n.pingTimer&&(n.pingTimer.clear(),n.pingTimer=null)})),this.on("close",this._setupReconnect),o.EventEmitter.call(this),this._setupStream()}a(g,o.EventEmitter),g.prototype._setupStream=function(){var t,e=this,r=new u,o=c.parser(this.options),i=null,a=[];function l(){n.nextTick(p)}function p(){var t=a.shift(),r=i;t?e._handlePacket(t,l):(i=null,r())}this._clearReconnect(),this.stream=this.streamBuilder(this),o.on("packet",(function(t){a.push(t)})),r._write=function(t,e,r){i=r,o.parse(t),p()},this.stream.pipe(r),this.stream.on("error",y),s(this.stream,this.emit.bind(this,"close")),(t=Object.create(this.options)).cmd="connect",d(this,t),o.on("error",this.emit.bind(this,"error")),this.stream.setMaxListeners(1e3),clearTimeout(this.connackTimer),this.connackTimer=setTimeout((function(){e._cleanUp(!0)}),this.options.connectTimeout)},g.prototype._handlePacket=function(t,e){switch(this.emit("packetreceive",t),t.cmd){case"publish":this._handlePublish(t,e);break;case"puback":case"pubrec":case"pubcomp":case"suback":case"unsuback":this._handleAck(t),e();break;case"pubrel":this._handlePubrel(t,e);break;case"connack":this._handleConnack(t),e();break;case"pingresp":this._handlePingresp(t),e()}},g.prototype._checkDisconnecting=function(t){return this.disconnecting&&(t?t(new Error("client disconnecting")):this.emit("error",new Error("client disconnecting"))),this.disconnecting},g.prototype.publish=function(t,e,r,n){var o;"function"===typeof r&&(n=r,r=null);if(r=f({qos:0,retain:!1,dup:!1},r),this._checkDisconnecting(n))return this;switch(o={cmd:"publish",topic:t,payload:e,qos:r.qos,retain:r.retain,messageId:this._nextId(),dup:r.dup},r.qos){case 1:case 2:this.outgoing[o.messageId]=n||y,this._sendPacket(o);break;default:this._sendPacket(o,n)}return this},g.prototype.subscribe=function(){var t,e,r=Array.prototype.slice.call(arguments),n=[],o=r.shift(),i=o.resubscribe,s=r.pop()||y,c=r.pop(),u=this;if(delete o.resubscribe,"string"===typeof o&&(o=[o]),"function"!==typeof s&&(c=s,s=y),null!==(e=p.validateTopics(o)))return h(s,new Error("Invalid topic "+e)),this;if(this._checkDisconnecting(s))return this;var a={qos:0};if(c=f(a,c),Array.isArray(o)?o.forEach((function(t){(u._resubscribeTopics[t]<c.qos||!u._resubscribeTopics.hasOwnProperty(t)||i)&&n.push({topic:t,qos:c.qos})})):Object.keys(o).forEach((function(t){(u._resubscribeTopics[t]<o[t]||!u._resubscribeTopics.hasOwnProperty(t)||i)&&n.push({topic:t,qos:o[t]})})),t={cmd:"subscribe",subscriptions:n,qos:1,retain:!1,dup:!1,messageId:this._nextId()},n.length){if(this.options.resubscribe){var l=[];n.forEach((function(t){u.options.reconnectPeriod>0&&(u._resubscribeTopics[t.topic]=t.qos,l.push(t.topic))})),u.messageIdToTopic[t.messageId]=l}return this.outgoing[t.messageId]=function(t,e){if(!t)for(var r=e.granted,o=0;o<r.length;o+=1)n[o].qos=r[o];s(t,n)},this._sendPacket(t),this}s(null,[])},g.prototype.unsubscribe=function(t,e){var r={cmd:"unsubscribe",qos:1,messageId:this._nextId()},n=this;return e=e||y,this._checkDisconnecting(e)||("string"===typeof t?r.unsubscriptions=[t]:"object"===typeof t&&t.length&&(r.unsubscriptions=t),this.options.resubscribe&&r.unsubscriptions.forEach((function(t){delete n._resubscribeTopics[t]})),this.outgoing[r.messageId]=e,this._sendPacket(r)),this},g.prototype.end=function(t,e){var r=this;function n(){r.disconnected=!0,r.incomingStore.close((function(){r.outgoingStore.close((function(){e&&e.apply(null,arguments),r.emit("end")}))})),r._deferredReconnect&&r._deferredReconnect()}function o(){r._cleanUp(t,h.bind(null,n))}return"function"===typeof t&&(e=t,t=!1),this.disconnecting||(this._clearReconnect(),this.disconnecting=!0,!t&&Object.keys(this.outgoing).length>0?this.once("outgoingEmpty",setTimeout.bind(null,o,10)):o()),this},g.prototype.removeOutgoingMessage=function(t){var e=this.outgoing[t];return delete this.outgoing[t],this.outgoingStore.del({messageId:t},(function(){e(new Error("Message removed"))})),this},g.prototype.reconnect=function(t){var e=this,r=function(){t?(e.options.incomingStore=t.incomingStore,e.options.outgoingStore=t.outgoingStore):(e.options.incomingStore=null,e.options.outgoingStore=null),e.incomingStore=e.options.incomingStore||new i,e.outgoingStore=e.options.outgoingStore||new i,e.disconnecting=!1,e.disconnected=!1,e._deferredReconnect=null,e._reconnect()};return this.disconnecting&&!this.disconnected?this._deferredReconnect=r:r(),this},g.prototype._reconnect=function(){this.emit("reconnect"),this._setupStream()},g.prototype._setupReconnect=function(){var t=this;!t.disconnecting&&!t.reconnectTimer&&t.options.reconnectPeriod>0&&(this.reconnecting||(this.emit("offline"),this.reconnecting=!0),t.reconnectTimer=setInterval((function(){t._reconnect()}),t.options.reconnectPeriod))},g.prototype._clearReconnect=function(){this.reconnectTimer&&(clearInterval(this.reconnectTimer),this.reconnectTimer=null)},g.prototype._cleanUp=function(t,e){var r;e&&this.stream.on("close",e),t?(0===this.options.reconnectPeriod&&this.options.clean&&(r=this.outgoing)&&Object.keys(r).forEach((function(t){"function"===typeof r[t]&&(r[t](new Error("Connection closed")),delete r[t])})),this.stream.destroy()):this._sendPacket({cmd:"disconnect"},h.bind(null,this.stream.end.bind(this.stream))),this.disconnecting||(this._clearReconnect(),this._setupReconnect()),null!==this.pingTimer&&(this.pingTimer.clear(),this.pingTimer=null),e&&!this.connected&&(this.stream.removeListener("close",e),e())},g.prototype._sendPacket=function(t,e){if(this.connected){switch(this._shiftPingInterval(),t.cmd){case"publish":break;case"pubrel":return void b(this,t,e);default:return void d(this,t,e)}switch(t.qos){case 2:case 1:b(this,t,e);break;default:d(this,t,e)}}else 0===(t.qos||0)&&this.queueQoSZero||"publish"!==t.cmd?this.queue.push({packet:t,cb:e}):t.qos>0?(e=this.outgoing[t.messageId],this.outgoingStore.put(t,(function(t){if(t)return e&&e(t)}))):e&&e(new Error("No connection to broker"))},g.prototype._setupPingTimer=function(){var t=this;!this.pingTimer&&this.options.keepalive&&(this.pingResp=!0,this.pingTimer=l((function(){t._checkPing()}),1e3*this.options.keepalive))},g.prototype._shiftPingInterval=function(){this.pingTimer&&this.options.keepalive&&this.options.reschedulePings&&this.pingTimer.reschedule(1e3*this.options.keepalive)},g.prototype._checkPing=function(){this.pingResp?(this.pingResp=!1,this._sendPacket({cmd:"pingreq"})):this._cleanUp(!0)},g.prototype._handlePingresp=function(){this.pingResp=!0},g.prototype._handleConnack=function(t){var e=t.returnCode;if(clearTimeout(this.connackTimer),0===e)this.reconnecting=!1,this.emit("connect",t);else if(e>0){var r=new Error("Connection refused: "+["","Unacceptable protocol version","Identifier rejected","Server unavailable","Bad username or password","Not authorized"][e]);r.code=e,this.emit("error",r)}},g.prototype._handlePublish=function(t,e){e="undefined"!==typeof e?e:y;var r=t.topic.toString(),n=t.payload,o=t.qos,i=t.messageId,s=this;switch(o){case 2:this.incomingStore.put(t,(function(t){if(t)return e(t);s._sendPacket({cmd:"pubrec",messageId:i},e)}));break;case 1:this.emit("message",r,n,t),this.handleMessage(t,(function(t){if(t)return e(t);s._sendPacket({cmd:"puback",messageId:i},e)}));break;case 0:this.emit("message",r,n,t),this.handleMessage(t,e)}},g.prototype.handleMessage=function(t,e){e()},g.prototype._handleAck=function(t){var e=t.messageId,r=t.cmd,n=null,o=this.outgoing[e],i=this;if(o){switch(r){case"pubcomp":case"puback":delete this.outgoing[e],this.outgoingStore.del(t,o);break;case"pubrec":n={cmd:"pubrel",qos:2,messageId:e},this._sendPacket(n);break;case"suback":if(delete this.outgoing[e],1===t.granted.length&&0!==(128&t.granted[0])){var s=this.messageIdToTopic[e];s&&s.forEach((function(t){delete i._resubscribeTopics[t]}))}o(null,t);break;case"unsuback":delete this.outgoing[e],o(null);break;default:i.emit("error",new Error("unrecognized packet type"))}this.disconnecting&&0===Object.keys(this.outgoing).length&&this.emit("outgoingEmpty")}},g.prototype._handlePubrel=function(t,e){e="undefined"!==typeof e?e:y;var r=t.messageId,n=this,o={cmd:"pubcomp",messageId:r};n.incomingStore.get(t,(function(r,i){r||"pubrel"===i.cmd?n._sendPacket(o,e):(n.emit("message",i.topic,i.payload,i),n.incomingStore.put(t,(function(t){if(t)return e(t);n.handleMessage(i,(function(t){if(t)return e(t);n._sendPacket(o,e)}))})))}))},g.prototype._nextId=function(){var t=this.nextId++;return 65536===this.nextId&&(this.nextId=1),t},g.prototype.getLastMessageId=function(){return 1===this.nextId?65535:this.nextId-1},t.exports=g}).call(this,r(125),r(417))},1507:function(t,e,r){"use strict";t.exports=r(1508)()?Map:r(1509)},1508:function(t,e,r){"use strict";t.exports=function(){var t,e;if("function"!==typeof Map)return!1;try{t=new Map([["raz","one"],["dwa","two"],["trzy","three"]])}catch(r){return!1}return"[object Map]"===String(t)&&(3===t.size&&("function"===typeof t.clear&&("function"===typeof t.delete&&("function"===typeof t.entries&&("function"===typeof t.forEach&&("function"===typeof t.get&&("function"===typeof t.has&&("function"===typeof t.keys&&("function"===typeof t.set&&("function"===typeof t.values&&(!1===(e=t.entries().next()).done&&(!!e.value&&("raz"===e.value[0]&&"one"===e.value[1])))))))))))))}},1509:function(t,e,r){"use strict";var n,o=r(1067),i=r(1511),s=r(752),c=r(600),u=r(562),a=r(547),l=r(1530),p=r(583),f=r(1075),h=r(1540),_=r(1558),d=r(1561),b=Function.prototype.call,y=Object.defineProperties,g=Object.getPrototypeOf;t.exports=n=function(){var t,e,r,o=arguments[0];if(!(this instanceof n))throw new TypeError("Constructor requires 'new'");return r=d&&s&&Map!==n?s(new Map,g(this)):this,null!=o&&f(o),y(r,{__mapKeysData__:a("c",t=[]),__mapValuesData__:a("c",e=[])}),o?(h(o,(function(r){var n=u(r)[0];r=r[1],-1===i.call(t,n)&&(t.push(n),e.push(r))}),r),r):r},d&&(s&&s(n,Map),n.prototype=Object.create(Map.prototype,{constructor:a(n)})),l(y(n.prototype,{clear:a((function(){this.__mapKeysData__.length&&(o.call(this.__mapKeysData__),o.call(this.__mapValuesData__),this.emit("_clear"))})),delete:a((function(t){var e=i.call(this.__mapKeysData__,t);return-1!==e&&(this.__mapKeysData__.splice(e,1),this.__mapValuesData__.splice(e,1),this.emit("_delete",e,t),!0)})),entries:a((function(){return new _(this,"key+value")})),forEach:a((function(t){var e,r,n=arguments[1];for(c(t),r=(e=this.entries())._next();void 0!==r;)b.call(t,n,this.__mapValuesData__[r],this.__mapKeysData__[r],this),r=e._next()})),get:a((function(t){var e=i.call(this.__mapKeysData__,t);if(-1!==e)return this.__mapValuesData__[e]})),has:a((function(t){return-1!==i.call(this.__mapKeysData__,t)})),keys:a((function(){return new _(this,"key")})),set:a((function(t,e){var r,n=i.call(this.__mapKeysData__,t);return-1===n&&(n=this.__mapKeysData__.push(t)-1,r=!0),this.__mapValuesData__[n]=e,r&&this.emit("_add",n,t),this})),size:a.gs((function(){return this.__mapKeysData__.length})),values:a((function(){return new _(this,"value")})),toString:a((function(){return"[object Map]"}))})),Object.defineProperty(n.prototype,p.iterator,a((function(){return this.entries()}))),Object.defineProperty(n.prototype,p.toStringTag,a("c","Map"))},1510:function(t,e,r){"use strict";t.exports=function(){}},1511:function(t,e,r){"use strict";var n=r(1512),o=r(1068),i=r(562),s=Array.prototype.indexOf,c=Object.prototype.hasOwnProperty,u=Math.abs,a=Math.floor;t.exports=function(t){var e,r,l,p;if(!n(t))return s.apply(this,arguments);for(r=o(i(this).length),l=arguments[1],e=l=isNaN(l)?0:l>=0?a(l):o(this.length)-a(u(l));e<r;++e)if(c.call(this,e)&&(p=this[e],n(p)))return e;return-1}},1512:function(t,e,r){"use strict";t.exports=r(1513)()?Number.isNaN:r(1514)},1513:function(t,e,r){"use strict";t.exports=function(){var t=Number.isNaN;return"function"===typeof t&&(!t({})&&t(NaN)&&!t(34))}},1514:function(t,e,r){"use strict";t.exports=function(t){return t!==t}},1515:function(t,e,r){"use strict";var n=r(1516),o=Math.abs,i=Math.floor;t.exports=function(t){return isNaN(t)?0:0!==(t=Number(t))&&isFinite(t)?n(t)*i(o(t)):t}},1516:function(t,e,r){"use strict";t.exports=r(1517)()?Math.sign:r(1518)},1517:function(t,e,r){"use strict";t.exports=function(){var t=Math.sign;return"function"===typeof t&&(1===t(10)&&-1===t(-20))}},1518:function(t,e,r){"use strict";t.exports=function(t){return t=Number(t),isNaN(t)||0===t?t:t>0?1:-1}},1519:function(t,e,r){"use strict";var n=r(642),o={function:!0,object:!0};t.exports=function(t){return n(t)&&o[typeof t]||!1}},1520:function(t,e,r){"use strict";var n,o=Object.create;r(1069)()||(n=r(1070)),t.exports=function(){var t,e,r;return n?1!==n.level?o:(t={},e={},r={configurable:!1,enumerable:!1,writable:!0,value:void 0},Object.getOwnPropertyNames(Object.prototype).forEach((function(t){e[t]="__proto__"!==t?r:{configurable:!0,enumerable:!1,writable:!0,value:void 0}})),Object.defineProperties(t,e),Object.defineProperty(n,"nullPolyfill",{configurable:!1,enumerable:!1,writable:!1,value:t}),function(e,r){return o(null===e?t:e,r)}):o}()},1521:function(t,e,r){"use strict";var n=r(1522);t.exports=function(t){if("function"!==typeof t)return!1;if(!hasOwnProperty.call(t,"length"))return!1;try{if("number"!==typeof t.length)return!1;if("function"!==typeof t.call)return!1;if("function"!==typeof t.apply)return!1}catch(e){return!1}return!n(t)}},1522:function(t,e,r){"use strict";var n=r(855);t.exports=function(t){if(!n(t))return!1;try{return!!t.constructor&&t.constructor.prototype===t}catch(e){return!1}}},1523:function(t,e,r){"use strict";t.exports=function(){var t,e=Object.assign;return"function"===typeof e&&(e(t={foo:"raz"},{bar:"dwa"},{trzy:"trzy"}),t.foo+t.bar+t.trzy==="razdwatrzy")}},1524:function(t,e,r){"use strict";var n=r(1525),o=r(562),i=Math.max;t.exports=function(t,e){var r,s,c,u=i(arguments.length,2);for(t=Object(o(t)),c=function(n){try{t[n]=e[n]}catch(o){r||(r=o)}},s=1;s<u;++s)n(e=arguments[s]).forEach(c);if(void 0!==r)throw r;return t}},1525:function(t,e,r){"use strict";t.exports=r(1526)()?Object.keys:r(1527)},1526:function(t,e,r){"use strict";t.exports=function(){try{return Object.keys("primitive"),!0}catch(t){return!1}}},1527:function(t,e,r){"use strict";var n=r(642),o=Object.keys;t.exports=function(t){return o(n(t)?Object(t):t)}},1528:function(t,e,r){"use strict";var n="razdwatrzy";t.exports=function(){return"function"===typeof n.contains&&(!0===n.contains("dwa")&&!1===n.contains("foo"))}},1529:function(t,e,r){"use strict";var n=String.prototype.indexOf;t.exports=function(t){return n.call(this,t,arguments[1])>-1}},1530:function(t,e,r){"use strict";var n,o,i,s,c,u,a,l=r(547),p=r(600),f=Function.prototype.apply,h=Function.prototype.call,_=Object.create,d=Object.defineProperty,b=Object.defineProperties,y=Object.prototype.hasOwnProperty,g={configurable:!0,enumerable:!1,writable:!0};o=function(t,e){var r,o;return p(e),o=this,n.call(this,t,r=function(){i.call(o,t,r),f.call(e,this,arguments)}),r.__eeOnceListener__=e,this},s=function(t){var e,r,n,o,i;if(y.call(this,"__ee__")&&(o=this.__ee__[t]))if("object"===typeof o){for(r=arguments.length,i=new Array(r-1),e=1;e<r;++e)i[e-1]=arguments[e];for(o=o.slice(),e=0;n=o[e];++e)f.call(n,this,i)}else switch(arguments.length){case 1:h.call(o,this);break;case 2:h.call(o,this,arguments[1]);break;case 3:h.call(o,this,arguments[1],arguments[2]);break;default:for(r=arguments.length,i=new Array(r-1),e=1;e<r;++e)i[e-1]=arguments[e];f.call(o,this,i)}},c={on:n=function(t,e){var r;return p(e),y.call(this,"__ee__")?r=this.__ee__:(r=g.value=_(null),d(this,"__ee__",g),g.value=null),r[t]?"object"===typeof r[t]?r[t].push(e):r[t]=[r[t],e]:r[t]=e,this},once:o,off:i=function(t,e){var r,n,o,i;if(p(e),!y.call(this,"__ee__"))return this;if(!(r=this.__ee__)[t])return this;if("object"===typeof(n=r[t]))for(i=0;o=n[i];++i)o!==e&&o.__eeOnceListener__!==e||(2===n.length?r[t]=n[i?0:1]:n.splice(i,1));else n!==e&&n.__eeOnceListener__!==e||delete r[t];return this},emit:s},u={on:l(n),once:l(o),off:l(i),emit:l(s)},a=b({},u),t.exports=e=function(t){return null==t?_(a):b(Object(t),u)},e.methods=c},1531:function(t,e,r){"use strict";var n=r(753),o={object:!0,symbol:!0};t.exports=function(){var t,e=n.Symbol;if("function"!==typeof e)return!1;t=e("test symbol");try{String(t)}catch(r){return!1}return!!o[typeof e.iterator]&&(!!o[typeof e.toPrimitive]&&!!o[typeof e.toStringTag])}},1532:function(t,e,r){"use strict";t.exports=function(){return"object"===typeof globalThis&&(!!globalThis&&globalThis.Array===Array)}},1533:function(t,e){var r=function(){if("object"===typeof self&&self)return self;if("object"===typeof window&&window)return window;throw new Error("Unable to resolve global `this`")};t.exports=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(t){return r()}try{return __global__||r()}finally{delete Object.prototype.__global__}}()},1534:function(t,e,r){"use strict";var n,o,i,s=r(547),c=r(1074),u=r(753).Symbol,a=r(1536),l=r(1537),p=r(1538),f=Object.create,h=Object.defineProperties,_=Object.defineProperty;if("function"===typeof u)try{String(u()),i=!0}catch(d){}else u=null;o=function(t){if(this instanceof o)throw new TypeError("Symbol is not a constructor");return n(t)},t.exports=n=function t(e){var r;if(this instanceof t)throw new TypeError("Symbol is not a constructor");return i?u(e):(r=f(o.prototype),e=void 0===e?"":String(e),h(r,{__description__:s("",e),__name__:s("",a(e))}))},l(n),p(n),h(o.prototype,{constructor:s(n),toString:s("",(function(){return this.__name__}))}),h(n.prototype,{toString:s((function(){return"Symbol ("+c(this).__description__+")"})),valueOf:s((function(){return c(this)}))}),_(n.prototype,n.toPrimitive,s("",(function(){var t=c(this);return"symbol"===typeof t?t:t.toString()}))),_(n.prototype,n.toStringTag,s("c","Symbol")),_(o.prototype,n.toStringTag,s("c",n.prototype[n.toStringTag])),_(o.prototype,n.toPrimitive,s("c",n.prototype[n.toPrimitive]))},1535:function(t,e,r){"use strict";t.exports=function(t){return!!t&&("symbol"===typeof t||!!t.constructor&&("Symbol"===t.constructor.name&&"Symbol"===t[t.constructor.toStringTag]))}},1536:function(t,e,r){"use strict";var n=r(547),o=Object.create,i=Object.defineProperty,s=Object.prototype,c=o(null);t.exports=function(t){for(var e,r,o=0;c[t+(o||"")];)++o;return c[t+=o||""]=!0,i(s,e="@@"+t,n.gs(null,(function(t){r||(r=!0,i(this,e,n(t)),r=!1)}))),e}},1537:function(t,e,r){"use strict";var n=r(547),o=r(753).Symbol;t.exports=function(t){return Object.defineProperties(t,{hasInstance:n("",o&&o.hasInstance||t("hasInstance")),isConcatSpreadable:n("",o&&o.isConcatSpreadable||t("isConcatSpreadable")),iterator:n("",o&&o.iterator||t("iterator")),match:n("",o&&o.match||t("match")),replace:n("",o&&o.replace||t("replace")),search:n("",o&&o.search||t("search")),species:n("",o&&o.species||t("species")),split:n("",o&&o.split||t("split")),toPrimitive:n("",o&&o.toPrimitive||t("toPrimitive")),toStringTag:n("",o&&o.toStringTag||t("toStringTag")),unscopables:n("",o&&o.unscopables||t("unscopables"))})}},1538:function(t,e,r){"use strict";var n=r(547),o=r(1074),i=Object.create(null);t.exports=function(t){return Object.defineProperties(t,{for:n((function(e){return i[e]?i[e]:i[e]=t(String(e))})),keyFor:n((function(t){var e;for(e in o(t),i)if(i[e]===t)return e}))})}},1539:function(t,e,r){"use strict";var n=r(754),o=r(642),i=r(755),s=r(583).iterator,c=Array.isArray;t.exports=function(t){return!!o(t)&&(!!c(t)||(!!i(t)||(!!n(t)||"function"===typeof t[s])))}},1540:function(t,e,r){"use strict";var n=r(754),o=r(600),i=r(755),s=r(1541),c=Array.isArray,u=Function.prototype.call,a=Array.prototype.some;t.exports=function(t,e){var r,l,p,f,h,_,d,b,y=arguments[2];if(c(t)||n(t)?r="array":i(t)?r="string":t=s(t),o(e),p=function(){f=!0},"array"!==r)if("string"!==r)for(l=t.next();!l.done;){if(u.call(e,y,l.value,p),f)return;l=t.next()}else for(_=t.length,h=0;h<_&&(d=t[h],h+1<_&&(b=d.charCodeAt(0))>=55296&&b<=56319&&(d+=t[++h]),u.call(e,y,d,p),!f);++h);else a.call(t,(function(t){return u.call(e,y,t,p),f}))}},1541:function(t,e,r){"use strict";var n=r(754),o=r(755),i=r(1542),s=r(1557),c=r(1075),u=r(583).iterator;t.exports=function(t){return"function"===typeof c(t)[u]?t[u]():n(t)?new i(t):o(t)?new s(t):new i(t)}},1542:function(t,e,r){"use strict";var n,o=r(752),i=r(1073),s=r(547),c=r(583),u=r(857),a=Object.defineProperty;n=t.exports=function(t,e){if(!(this instanceof n))throw new TypeError("Constructor requires 'new'");u.call(this,t),e=e?i.call(e,"key+value")?"key+value":i.call(e,"key")?"key":"value":"value",a(this,"__kind__",s("",e))},o&&o(n,u),delete n.prototype.constructor,n.prototype=Object.create(u.prototype,{_resolve:s((function(t){return"value"===this.__kind__?this.__list__[t]:"key+value"===this.__kind__?[t,this.__list__[t]]:t}))}),a(n.prototype,c.toStringTag,s("c","Array Iterator"))},1543:function(t,e,r){"use strict";var n,o=r(643),i=r(1544),s=r(1548),c=r(1549),u=r(1072),a=r(1554),l=Function.prototype.bind,p=Object.defineProperty,f=Object.prototype.hasOwnProperty;n=function(t,e,r){var n,o=i(e)&&s(e.value);return delete(n=c(e)).writable,delete n.value,n.get=function(){return!r.overwriteDefinition&&f.call(this,t)?o:(e.value=l.call(o,r.resolveContext?r.resolveContext(this):this),p(this,t,e),this[t])},n},t.exports=function(t){var e=u(arguments[1]);return o(e.resolveContext)&&s(e.resolveContext),a(t,(function(t,r){return n(r,t,e)}))}},1544:function(t,e,r){"use strict";var n=r(1076),o=r(643);t.exports=function(t){return o(t)?t:n(t,"Cannot use %v",arguments[1])}},1545:function(t,e,r){"use strict";var n=r(643),o=r(855),i=Object.prototype.toString;t.exports=function(t){if(!n(t))return null;if(o(t)){var e=t.toString;if("function"!==typeof e)return null;if(e===i)return null}try{return""+t}catch(r){return null}}},1546:function(t,e,r){"use strict";var n=r(1547),o=/[\n\r\u2028\u2029]/g;t.exports=function(t){var e=n(t);return null===e?"<Non-coercible to string value>":(e.length>100&&(e=e.slice(0,99)+"\u2026"),e=e.replace(o,(function(t){switch(t){case"\n":return"\\n";case"\r":return"\\r";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw new Error("Unexpected character")}})))}},1547:function(t,e,r){"use strict";t.exports=function(t){try{return t.toString()}catch(e){try{return String(t)}catch(r){return null}}}},1548:function(t,e,r){"use strict";var n=r(1076),o=r(1071);t.exports=function(t){return o(t)?t:n(t,"%v is not a plain function",arguments[1])}},1549:function(t,e,r){"use strict";var n=r(1550),o=r(856),i=r(562);t.exports=function(t){var e=Object(i(t)),r=arguments[1],s=Object(arguments[2]);if(e!==t&&!r)return e;var c={};return r?n(r,(function(e){(s.ensure||e in t)&&(c[e]=t[e])})):o(c,t),c}},1550:function(t,e,r){"use strict";t.exports=r(1551)()?Array.from:r(1552)},1551:function(t,e,r){"use strict";t.exports=function(){var t,e,r=Array.from;return"function"===typeof r&&(e=r(t=["raz","dwa"]),Boolean(e&&e!==t&&"dwa"===e[1]))}},1552:function(t,e,r){"use strict";var n=r(583).iterator,o=r(754),i=r(1553),s=r(1068),c=r(600),u=r(562),a=r(642),l=r(755),p=Array.isArray,f=Function.prototype.call,h={configurable:!0,enumerable:!0,writable:!0,value:null},_=Object.defineProperty;t.exports=function(t){var e,r,d,b,y,g,v,m,w,S,E=arguments[1],k=arguments[2];if(t=Object(u(t)),a(E)&&c(E),this&&this!==Array&&i(this))e=this;else{if(!E){if(o(t))return 1!==(y=t.length)?Array.apply(null,t):((b=new Array(1))[0]=t[0],b);if(p(t)){for(b=new Array(y=t.length),r=0;r<y;++r)b[r]=t[r];return b}}b=[]}if(!p(t))if(void 0!==(w=t[n])){for(v=c(w).call(t),e&&(b=new e),m=v.next(),r=0;!m.done;)S=E?f.call(E,k,m.value,r):m.value,e?(h.value=S,_(b,r,h)):b[r]=S,m=v.next(),++r;y=r}else if(l(t)){for(y=t.length,e&&(b=new e),r=0,d=0;r<y;++r)S=t[r],r+1<y&&(g=S.charCodeAt(0))>=55296&&g<=56319&&(S+=t[++r]),S=E?f.call(E,k,S,d):S,e?(h.value=S,_(b,d,h)):b[d]=S,++d;y=d}if(void 0===y)for(y=s(t.length),e&&(b=new e(y)),r=0;r<y;++r)S=E?f.call(E,k,t[r],r):t[r],e?(h.value=S,_(b,r,h)):b[r]=S;return e&&(h.value=null,b.length=y),b}},1553:function(t,e,r){"use strict";var n=Object.prototype.toString,o=RegExp.prototype.test.bind(/^[object [A-Za-z0-9]*Function]$/);t.exports=function(t){return"function"===typeof t&&o(n.call(t))}},1554:function(t,e,r){"use strict";var n=r(600),o=r(1555),i=Function.prototype.call;t.exports=function(t,e){var r={},s=arguments[2];return n(e),o(t,(function(t,n,o,c){r[n]=i.call(e,s,t,n,o,c)})),r}},1555:function(t,e,r){"use strict";t.exports=r(1556)("forEach")},1556:function(t,e,r){"use strict";var n=r(600),o=r(562),i=Function.prototype.bind,s=Function.prototype.call,c=Object.keys,u=Object.prototype.propertyIsEnumerable;t.exports=function(t,e){return function(r,a){var l,p=arguments[2],f=arguments[3];return r=Object(o(r)),n(a),l=c(r),f&&l.sort("function"===typeof f?i.call(f,r):void 0),"function"!==typeof t&&(t=l[t]),s.call(t,l,(function(t,n){return u.call(r,t)?s.call(a,p,r[t],t,r,n):e}))}}},1557:function(t,e,r){"use strict";var n,o=r(752),i=r(547),s=r(583),c=r(857),u=Object.defineProperty;n=t.exports=function(t){if(!(this instanceof n))throw new TypeError("Constructor requires 'new'");t=String(t),c.call(this,t),u(this,"__length__",i("",t.length))},o&&o(n,c),delete n.prototype.constructor,n.prototype=Object.create(c.prototype,{_next:i((function(){if(this.__list__)return this.__nextIndex__<this.__length__?this.__nextIndex__++:void this._unBind()})),_resolve:i((function(t){var e,r=this.__list__[t];return this.__nextIndex__===this.__length__?r:(e=r.charCodeAt(0))>=55296&&e<=56319?r+this.__list__[this.__nextIndex__++]:r}))}),u(n.prototype,s.toStringTag,i("c","String Iterator"))},1558:function(t,e,r){"use strict";var n,o=r(752),i=r(547),s=r(857),c=r(583).toStringTag,u=r(1559),a=Object.defineProperties,l=s.prototype._unBind;n=t.exports=function(t,e){if(!(this instanceof n))return new n(t,e);s.call(this,t.__mapKeysData__,t),e&&u[e]||(e="key+value"),a(this,{__kind__:i("",e),__values__:i("w",t.__mapValuesData__)})},o&&o(n,s),n.prototype=Object.create(s.prototype,{constructor:i(n),_resolve:i((function(t){return"value"===this.__kind__?this.__values__[t]:"key"===this.__kind__?this.__list__[t]:[this.__list__[t],this.__values__[t]]})),_unBind:i((function(){this.__values__=null,l.call(this)})),toString:i((function(){return"[object Map Iterator]"}))}),Object.defineProperty(n.prototype,c,i("c","Map Iterator"))},1559:function(t,e,r){"use strict";t.exports=r(1560)("key","value","key+value")},1560:function(t,e,r){"use strict";var n=Array.prototype.forEach,o=Object.create;t.exports=function(t){var e=o(null);return n.call(arguments,(function(t){e[t]=!0})),e}},1561:function(t,e,r){"use strict";t.exports="undefined"!==typeof Map&&"[object Map]"===Object.prototype.toString.call(new Map)},1562:function(t,e,r){var n=r(1563);function o(t){var e=function(){return e.called?e.value:(e.called=!0,e.value=t.apply(this,arguments))};return e.called=!1,e}function i(t){var e=function(){if(e.called)throw new Error(e.onceError);return e.called=!0,e.value=t.apply(this,arguments)},r=t.name||"Function wrapped with `once`";return e.onceError=r+" shouldn't be called more than once",e.called=!1,e}t.exports=n(o),t.exports.strict=n(i),o.proto=o((function(){Object.defineProperty(Function.prototype,"once",{value:function(){return o(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return i(this)},configurable:!0})}))},1563:function(t,e){t.exports=function t(e,r){if(e&&r)return t(e)(r);if("function"!==typeof e)throw new TypeError("need wrapper function");return Object.keys(e).forEach((function(t){n[t]=e[t]})),n;function n(){for(var t=new Array(arguments.length),r=0;r<t.length;r++)t[r]=arguments[r];var n=e.apply(this,t),o=t[t.length-1];return"function"===typeof n&&n!==o&&Object.keys(o).forEach((function(t){n[t]=o[t]})),n}}},1564:function(t,e,r){"use strict";e.parser=r(1565),e.generate=r(1570),e.writeToStream=r(1080)},1565:function(t,e,r){"use strict";var n=r(1566),o=r(399),i=r(466).EventEmitter,s=r(1569),c=r(1079);function u(){if(!(this instanceof u))return new u;this._states=["_parseHeader","_parseLength","_parsePayload","_newPacket"],this._resetState()}o(u,i),u.prototype._resetState=function(){this.packet=new s,this.error=null,this._list=n(),this._stateCounter=0},u.prototype.parse=function(t){for(this.error&&this._resetState(),this._list.append(t);(-1!==this.packet.length||this._list.length>0)&&this[this._states[this._stateCounter]]()&&!this.error;)this._stateCounter++,this._stateCounter>=this._states.length&&(this._stateCounter=0);return this._list.length},u.prototype._parseHeader=function(){var t=this._list.readUInt8(0);return this.packet.cmd=c.types[t>>c.CMD_SHIFT],this.packet.retain=0!==(t&c.RETAIN_MASK),this.packet.qos=t>>c.QOS_SHIFT&c.QOS_MASK,this.packet.dup=0!==(t&c.DUP_MASK),this._list.consume(1),!0},u.prototype._parseLength=function(){for(var t,e=0,r=1,n=0,o=!0;e<5&&(n+=r*((t=this._list.readUInt8(e++))&c.LENGTH_MASK),r*=128,0!==(t&c.LENGTH_FIN_MASK));)if(this._list.length<=e){o=!1;break}return o&&(this.packet.length=n,this._list.consume(e)),o},u.prototype._parsePayload=function(){var t=!1;if(0===this.packet.length||this._list.length>=this.packet.length){switch(this._pos=0,this.packet.cmd){case"connect":this._parseConnect();break;case"connack":this._parseConnack();break;case"publish":this._parsePublish();break;case"puback":case"pubrec":case"pubrel":case"pubcomp":this._parseMessageId();break;case"subscribe":this._parseSubscribe();break;case"suback":this._parseSuback();break;case"unsubscribe":this._parseUnsubscribe();break;case"unsuback":this._parseUnsuback();break;case"pingreq":case"pingresp":case"disconnect":break;default:this._emitError(new Error("Not supported"))}t=!0}return t},u.prototype._parseConnect=function(){var t,e,r,n,o,i,s={},u=this.packet;if(null===(t=this._parseString()))return this._emitError(new Error("Cannot parse protocolId"));if("MQTT"!==t&&"MQIsdp"!==t)return this._emitError(new Error("Invalid protocolId"));if(u.protocolId=t,this._pos>=this._list.length)return this._emitError(new Error("Packet too short"));if(u.protocolVersion=this._list.readUInt8(this._pos),3!==u.protocolVersion&&4!==u.protocolVersion)return this._emitError(new Error("Invalid protocol version"));if(this._pos++,this._pos>=this._list.length)return this._emitError(new Error("Packet too short"));if(s.username=this._list.readUInt8(this._pos)&c.USERNAME_MASK,s.password=this._list.readUInt8(this._pos)&c.PASSWORD_MASK,s.will=this._list.readUInt8(this._pos)&c.WILL_FLAG_MASK,s.will&&(u.will={},u.will.retain=0!==(this._list.readUInt8(this._pos)&c.WILL_RETAIN_MASK),u.will.qos=(this._list.readUInt8(this._pos)&c.WILL_QOS_MASK)>>c.WILL_QOS_SHIFT),u.clean=0!==(this._list.readUInt8(this._pos)&c.CLEAN_SESSION_MASK),this._pos++,u.keepalive=this._parseNum(),-1===u.keepalive)return this._emitError(new Error("Packet too short"));if(null===(e=this._parseString()))return this._emitError(new Error("Packet too short"));if(u.clientId=e,s.will){if(null===(r=this._parseString()))return this._emitError(new Error("Cannot parse will topic"));if(u.will.topic=r,null===(n=this._parseBuffer()))return this._emitError(new Error("Cannot parse will payload"));u.will.payload=n}if(s.username){if(null===(i=this._parseString()))return this._emitError(new Error("Cannot parse username"));u.username=i}if(s.password){if(null===(o=this._parseBuffer()))return this._emitError(new Error("Cannot parse password"));u.password=o}return u},u.prototype._parseConnack=function(){var t=this.packet;return this._list.length<2?null:(t.sessionPresent=!!(this._list.readUInt8(this._pos++)&c.SESSIONPRESENT_MASK),t.returnCode=this._list.readUInt8(this._pos),-1===t.returnCode?this._emitError(new Error("Cannot parse return code")):void 0)},u.prototype._parsePublish=function(){var t=this.packet;if(t.topic=this._parseString(),null===t.topic)return this._emitError(new Error("Cannot parse topic"));t.qos>0&&!this._parseMessageId()||(t.payload=this._list.slice(this._pos,t.length))},u.prototype._parseSubscribe=function(){var t,e,r=this.packet;if(1!==r.qos)return this._emitError(new Error("Wrong subscribe header"));if(r.subscriptions=[],this._parseMessageId())for(;this._pos<r.length;){if(null===(t=this._parseString()))return this._emitError(new Error("Cannot parse topic"));if(this._pos>=r.length)return this._emitError(new Error("Malformed Subscribe Payload"));e=this._list.readUInt8(this._pos++),r.subscriptions.push({topic:t,qos:e})}},u.prototype._parseSuback=function(){if(this.packet.granted=[],this._parseMessageId())for(;this._pos<this.packet.length;)this.packet.granted.push(this._list.readUInt8(this._pos++))},u.prototype._parseUnsubscribe=function(){var t=this.packet;if(t.unsubscriptions=[],this._parseMessageId())for(;this._pos<t.length;){var e;if(null===(e=this._parseString()))return this._emitError(new Error("Cannot parse topic"));t.unsubscriptions.push(e)}},u.prototype._parseUnsuback=function(){if(!this._parseMessageId())return this._emitError(new Error("Cannot parse messageId"))},u.prototype._parseMessageId=function(){var t=this.packet;return t.messageId=this._parseNum(),null!==t.messageId||(this._emitError(new Error("Cannot parse messageId")),!1)},u.prototype._parseString=function(t){var e,r=this._parseNum(),n=r+this._pos;return-1===r||n>this._list.length||n>this.packet.length?null:(e=this._list.toString("utf8",this._pos,n),this._pos+=r,e)},u.prototype._parseBuffer=function(){var t,e=this._parseNum(),r=e+this._pos;return-1===e||r>this._list.length||r>this.packet.length?null:(t=this._list.slice(this._pos,r),this._pos+=e,t)},u.prototype._parseNum=function(){if(this._list.length-this._pos<2)return-1;var t=this._list.readUInt16BE(this._pos);return this._pos+=2,t},u.prototype._newPacket=function(){return this.packet&&(this._list.consume(this.packet.length),this.emit("packet",this.packet)),this.packet=new s,!0},u.prototype._emitError=function(t){this.error=t,this.emit("error",t)},t.exports=u},1566:function(t,e,r){var n=r(1078),o=r(467),i=r(408).Buffer;function s(t){if(!(this instanceof s))return new s(t);if(this._bufs=[],this.length=0,"function"==typeof t){this._callback=t;var e=function(t){this._callback&&(this._callback(t),this._callback=null)}.bind(this);this.on("pipe",(function(t){t.on("error",e)})),this.on("unpipe",(function(t){t.removeListener("error",e)}))}else this.append(t);n.call(this)}o.inherits(s,n),s.prototype._offset=function(t){var e,r=0,n=0;if(0===t)return[0,0];for(;n<this._bufs.length;n++){if(t<(e=r+this._bufs[n].length)||n==this._bufs.length-1)return[n,t-r];r=e}},s.prototype.append=function(t){var e=0;if(i.isBuffer(t))this._appendBuffer(t);else if(Array.isArray(t))for(;e<t.length;e++)this.append(t[e]);else if(t instanceof s)for(;e<t._bufs.length;e++)this.append(t._bufs[e]);else null!=t&&("number"==typeof t&&(t=t.toString()),this._appendBuffer(i.from(t)));return this},s.prototype._appendBuffer=function(t){this._bufs.push(t),this.length+=t.length},s.prototype._write=function(t,e,r){this._appendBuffer(t),"function"==typeof r&&r()},s.prototype._read=function(t){if(!this.length)return this.push(null);t=Math.min(t,this.length),this.push(this.slice(0,t)),this.consume(t)},s.prototype.end=function(t){n.prototype.end.call(this,t),this._callback&&(this._callback(null,this.slice()),this._callback=null)},s.prototype.get=function(t){return this.slice(t,t+1)[0]},s.prototype.slice=function(t,e){return"number"==typeof t&&t<0&&(t+=this.length),"number"==typeof e&&e<0&&(e+=this.length),this.copy(null,0,t,e)},s.prototype.copy=function(t,e,r,n){if(("number"!=typeof r||r<0)&&(r=0),("number"!=typeof n||n>this.length)&&(n=this.length),r>=this.length)return t||i.alloc(0);if(n<=0)return t||i.alloc(0);var o,s,c=!!t,u=this._offset(r),a=n-r,l=a,p=c&&e||0,f=u[1];if(0===r&&n==this.length){if(!c)return 1===this._bufs.length?this._bufs[0]:i.concat(this._bufs,this.length);for(s=0;s<this._bufs.length;s++)this._bufs[s].copy(t,p),p+=this._bufs[s].length;return t}if(l<=this._bufs[u[0]].length-f)return c?this._bufs[u[0]].copy(t,e,f,f+l):this._bufs[u[0]].slice(f,f+l);for(c||(t=i.allocUnsafe(a)),s=u[0];s<this._bufs.length;s++){if(!(l>(o=this._bufs[s].length-f))){this._bufs[s].copy(t,p,f,f+l),p+=o;break}this._bufs[s].copy(t,p,f),p+=o,l-=o,f&&(f=0)}return t.length>p?t.slice(0,p):t},s.prototype.shallowSlice=function(t,e){t=t||0,e=e||this.length,t<0&&(t+=this.length),e<0&&(e+=this.length);var r=this._offset(t),n=this._offset(e),o=this._bufs.slice(r[0],n[0]+1);return 0==n[1]?o.pop():o[o.length-1]=o[o.length-1].slice(0,n[1]),0!=r[1]&&(o[0]=o[0].slice(r[1])),new s(o)},s.prototype.toString=function(t,e,r){return this.slice(e,r).toString(t)},s.prototype.consume=function(t){if(t=Math.trunc(t),Number.isNaN(t)||t<=0)return this;for(;this._bufs.length;){if(!(t>=this._bufs[0].length)){this._bufs[0]=this._bufs[0].slice(t),this.length-=t;break}t-=this._bufs[0].length,this.length-=this._bufs[0].length,this._bufs.shift()}return this},s.prototype.duplicate=function(){for(var t=0,e=new s;t<this._bufs.length;t++)e.append(this._bufs[t]);return e},s.prototype.destroy=function(){this._bufs.length=0,this.length=0,this.push(null)},function(){var t={readDoubleBE:8,readDoubleLE:8,readFloatBE:4,readFloatLE:4,readInt32BE:4,readInt32LE:4,readUInt32BE:4,readUInt32LE:4,readInt16BE:2,readInt16LE:2,readUInt16BE:2,readUInt16LE:2,readInt8:1,readUInt8:1};for(var e in t)!function(e){s.prototype[e]=function(r){return this.slice(r,r+t[e])[e](0)}}(e)}(),t.exports=s},1569:function(t,e){t.exports=function(){this.cmd=null,this.retain=!1,this.qos=0,this.dup=!1,this.length=-1,this.topic=null,this.payload=null}},1570:function(t,e,r){"use strict";var n=r(408).Buffer,o=r(1080),i=r(466).EventEmitter;function s(){this._array=new Array(20),this._i=0}r(399)(s,i),s.prototype.write=function(t){return this._array[this._i++]=t,!0},s.prototype.concat=function(){var t,e,r=0,o=new Array(this._array.length),i=this._array,s=0;for(t=0;t<i.length&&void 0!==i[t];t++)"string"!==typeof i[t]?o[t]=i[t].length:o[t]=n.byteLength(i[t]),r+=o[t];for(e=n.allocUnsafe(r),t=0;t<i.length&&void 0!==i[t];t++)"string"!==typeof i[t]?(i[t].copy(e,s),s+=o[t]):(e.write(i[t],s),s+=o[t]);return e},t.exports=function(t){var e=new s;return o(t,e),e.concat()}},1571:function(t,e,r){"use strict";var n=r(408).Buffer,o={};function i(t){var e=n.allocUnsafe(2);return e.writeUInt8(t>>8,0),e.writeUInt8(255&t,1),e}t.exports={cache:o,generateCache:function(){for(var t=0;t<65536;t++)o[t]=i(t)},generateNumber:i}},1572:function(t,e,r){"use strict";function n(t,e,r){var n=this;this._callback=t,this._args=r,this._interval=setInterval(t,e,this._args),this.reschedule=function(t){t||(t=n._interval),n._interval&&clearInterval(n._interval),n._interval=setInterval(n._callback,t,n._args)},this.clear=function(){n._interval&&(clearInterval(n._interval),n._interval=void 0)},this.destroy=function(){n._interval&&clearInterval(n._interval),n._callback=void 0,n._interval=void 0,n._args=void 0}}t.exports=function(){if("function"!==typeof arguments[0])throw new Error("callback needed");if("number"!==typeof arguments[1])throw new Error("interval needed");var t;if(arguments.length>0){t=new Array(arguments.length-2);for(var e=0;e<t.length;e++)t[e]=arguments[e+2]}return new n(arguments[0],arguments[1],t)}},1573:function(t,e,r){"use strict";function n(t){for(var e=t.split("/"),r=0;r<e.length;r++)if("+"!==e[r]){if("#"===e[r])return r===e.length-1;if(-1!==e[r].indexOf("+")||-1!==e[r].indexOf("#"))return!1}return!0}t.exports={validateTopics:function(t){if(0===t.length)return"empty_topic_list";for(var e=0;e<t.length;e++)if(!n(t[e]))return t[e];return null}}},1578:function(t,e){},1579:function(t,e){},1580:function(t,e,r){(function(e,n){var o=r(561),i=r(1077),s=r(399),c=r(1581),u=e.from&&e.from!==Uint8Array.from?e.from([0]):new e([0]),a=function(t,e){t._corked?t.once("uncork",e):e()},l=function(t,e){return function(r){r?function(t,e){t._autoDestroy&&t.destroy(e)}(t,"premature close"===r.message?null:r):e&&!t._ended&&t.end()}},p=function(t,e,r){if(!(this instanceof p))return new p(t,e,r);o.Duplex.call(this,r),this._writable=null,this._readable=null,this._readable2=null,this._autoDestroy=!r||!1!==r.autoDestroy,this._forwardDestroy=!r||!1!==r.destroy,this._forwardEnd=!r||!1!==r.end,this._corked=1,this._ondrain=null,this._drained=!1,this._forwarding=!1,this._unwrite=null,this._unread=null,this._ended=!1,this.destroyed=!1,t&&this.setWritable(t),e&&this.setReadable(e)};s(p,o.Duplex),p.obj=function(t,e,r){return r||(r={}),r.objectMode=!0,r.highWaterMark=16,new p(t,e,r)},p.prototype.cork=function(){1===++this._corked&&this.emit("cork")},p.prototype.uncork=function(){this._corked&&0===--this._corked&&this.emit("uncork")},p.prototype.setWritable=function(t){if(this._unwrite&&this._unwrite(),this.destroyed)t&&t.destroy&&t.destroy();else if(null!==t&&!1!==t){var e=this,r=i(t,{writable:!0,readable:!1},l(this,this._forwardEnd)),o=function(){var t=e._ondrain;e._ondrain=null,t&&t()};this._unwrite&&n.nextTick(o),this._writable=t,this._writable.on("drain",o),this._unwrite=function(){e._writable.removeListener("drain",o),r()},this.uncork()}else this.end()},p.prototype.setReadable=function(t){if(this._unread&&this._unread(),this.destroyed)t&&t.destroy&&t.destroy();else{if(null===t||!1===t)return this.push(null),void this.resume();var e,r=this,n=i(t,{writable:!1,readable:!0},l(this)),s=function(){r._forward()},c=function(){r.push(null)};this._drained=!0,this._readable=t,this._readable2=t._readableState?t:(e=t,new o.Readable({objectMode:!0,highWaterMark:16}).wrap(e)),this._readable2.on("readable",s),this._readable2.on("end",c),this._unread=function(){r._readable2.removeListener("readable",s),r._readable2.removeListener("end",c),n()},this._forward()}},p.prototype._read=function(){this._drained=!0,this._forward()},p.prototype._forward=function(){if(!this._forwarding&&this._readable2&&this._drained){var t;for(this._forwarding=!0;this._drained&&null!==(t=c(this._readable2));)this.destroyed||(this._drained=this.push(t));this._forwarding=!1}},p.prototype.destroy=function(t){if(!this.destroyed){this.destroyed=!0;var e=this;n.nextTick((function(){e._destroy(t)}))}},p.prototype._destroy=function(t){if(t){var e=this._ondrain;this._ondrain=null,e?e(t):this.emit("error",t)}this._forwardDestroy&&(this._readable&&this._readable.destroy&&this._readable.destroy(),this._writable&&this._writable.destroy&&this._writable.destroy()),this.emit("close")},p.prototype._write=function(t,e,r){return this.destroyed?r():this._corked?a(this,this._write.bind(this,t,e,r)):t===u?this._finish(r):this._writable?void(!1===this._writable.write(t)?this._ondrain=r:r()):r()},p.prototype._finish=function(t){var e=this;this.emit("preend"),a(this,(function(){var r,n;r=e._forwardEnd&&e._writable,n=function(){!1===e._writableState.prefinished&&(e._writableState.prefinished=!0),e.emit("prefinish"),a(e,t)},r?r._writableState&&r._writableState.finished?n():r._writableState?r.end(n):(r.end(),n()):n()}))},p.prototype.end=function(t,e,r){return"function"===typeof t?this.end(null,null,t):"function"===typeof e?this.end(t,null,e):(this._ended=!0,t&&this.write(t),this._writableState.ending||this.write(u),o.Writable.prototype.end.call(this,r))},t.exports=p}).call(this,r(424).Buffer,r(417))},1581:function(t,e){t.exports=function(t){var e=t._readableState;return e?e.objectMode||"number"===typeof t._duplexState?t.read():t.read(function(t){if(t.buffer.length)return t.buffer.head?t.buffer.head.data.length:t.buffer[0].length;return t.length}(e)):null}},1582:function(t,e){var r=null;"undefined"!==typeof WebSocket?r=WebSocket:"undefined"!==typeof MozWebSocket?r=MozWebSocket:"undefined"!==typeof window&&(r=window.WebSocket||window.MozWebSocket),t.exports=r},1800:function(t,e,r){"use strict";(function(e){var n=r(1498),o=r(1061),i=r(563),s=r(751),c={};function u(t,e){if("object"!==typeof t||e||(e=t,t=null),e=e||{},t){var r=i.parse(t,!0);if(null!=r.port&&(r.port=Number(r.port)),null===(e=s(r,e)).protocol)throw new Error("Missing protocol");e.protocol=e.protocol.replace(/:$/,"")}if(function(t){var e;t.auth&&((e=t.auth.match(/^(.+):(.+)$/))?(t.username=e[1],t.password=e[2]):t.username=t.auth)}(e),e.query&&"string"===typeof e.query.clientId&&(e.clientId=e.query.clientId),e.cert&&e.key){if(!e.protocol)throw new Error("Missing secure protocol key");if(-1===["mqtts","wss","wxs"].indexOf(e.protocol))switch(e.protocol){case"mqtt":e.protocol="mqtts";break;case"ws":e.protocol="wss";break;case"wx":e.protocol="wxs";break;default:throw new Error('Unknown protocol for secure connection: "'+e.protocol+'"!')}}if(!c[e.protocol]){var o=-1!==["mqtts","wss"].indexOf(e.protocol);e.protocol=["mqtt","mqtts","ws","wss","wx","wxs"].filter((function(t,e){return(!o||e%2!==0)&&"function"===typeof c[t]}))[0]}if(!1===e.clean&&!e.clientId)throw new Error("Missing clientId for unclean clients");return e.protocol&&(e.defaultProtocol=e.protocol),new n((function(t){return e.servers&&(t._reconnectCount&&t._reconnectCount!==e.servers.length||(t._reconnectCount=0),e.host=e.servers[t._reconnectCount].host,e.port=e.servers[t._reconnectCount].port,e.protocol=e.servers[t._reconnectCount].protocol?e.servers[t._reconnectCount].protocol:e.defaultProtocol,e.hostname=e.host,t._reconnectCount++),c[e.protocol](t,e)}),e)}"browser"!==e.title?(c.mqtt=r(1081),c.tcp=r(1081),c.ssl=r(858),c.tls=r(858),c.mqtts=r(858)):(c.wx=r(1082),c.wxs=r(1082)),c.ws=r(1084),c.wss=r(1084),t.exports=u,t.exports.connect=u,t.exports.MqttClient=n,t.exports.Store=o}).call(this,r(417))},547:function(t,e,r){"use strict";var n=r(643),o=r(1071),i=r(856),s=r(1072),c=r(1073),u=t.exports=function(t,e){var r,o,u,a,l;return arguments.length<2||"string"!==typeof t?(a=e,e=t,t=null):a=arguments[2],n(t)?(r=c.call(t,"c"),o=c.call(t,"e"),u=c.call(t,"w")):(r=u=!0,o=!1),l={value:e,configurable:r,enumerable:o,writable:u},a?i(s(a),l):l};u.gs=function(t,e,r){var u,a,l,p;return"string"!==typeof t?(l=r,r=e,e=t,t=null):l=arguments[3],n(e)?o(e)?n(r)?o(r)||(l=r,r=void 0):r=void 0:(l=e,e=r=void 0):e=void 0,n(t)?(u=c.call(t,"c"),a=c.call(t,"e")):(u=!0,a=!1),p={get:e,set:r,configurable:u,enumerable:a},l?i(s(l),p):p}},562:function(t,e,r){"use strict";var n=r(642);t.exports=function(t){if(!n(t))throw new TypeError("Cannot use null or undefined");return t}},583:function(t,e,r){"use strict";t.exports=r(1531)()?r(753).Symbol:r(1534)},600:function(t,e,r){"use strict";t.exports=function(t){if("function"!==typeof t)throw new TypeError(t+" is not a function");return t}},642:function(t,e,r){"use strict";var n=r(1510)();t.exports=function(t){return t!==n&&null!==t}},643:function(t,e,r){"use strict";t.exports=function(t){return undefined!==t&&null!==t}},752:function(t,e,r){"use strict";t.exports=r(1069)()?Object.setPrototypeOf:r(1070)},753:function(t,e,r){"use strict";t.exports=r(1532)()?globalThis:r(1533)},754:function(t,e,r){"use strict";var n=Object.prototype.toString,o=n.call(function(){return arguments}());t.exports=function(t){return n.call(t)===o}},755:function(t,e,r){"use strict";var n=Object.prototype.toString,o=n.call("");t.exports=function(t){return"string"===typeof t||t&&"object"===typeof t&&(t instanceof String||n.call(t)===o)||!1}},855:function(t,e,r){"use strict";var n=r(643),o={object:!0,function:!0,undefined:!0};t.exports=function(t){return!!n(t)&&hasOwnProperty.call(o,typeof t)}},856:function(t,e,r){"use strict";t.exports=r(1523)()?Object.assign:r(1524)},857:function(t,e,r){"use strict";var n,o=r(1067),i=r(856),s=r(600),c=r(562),u=r(547),a=r(1543),l=r(583),p=Object.defineProperty,f=Object.defineProperties;t.exports=n=function(t,e){if(!(this instanceof n))throw new TypeError("Constructor requires 'new'");f(this,{__list__:u("w",c(t)),__context__:u("w",e),__nextIndex__:u("w",0)}),e&&(s(e.on),e.on("_add",this._onAdd),e.on("_delete",this._onDelete),e.on("_clear",this._onClear))},delete n.prototype.constructor,f(n.prototype,i({_next:u((function(){var t;if(this.__list__)return this.__redo__&&void 0!==(t=this.__redo__.shift())?t:this.__nextIndex__<this.__list__.length?this.__nextIndex__++:void this._unBind()})),next:u((function(){return this._createResult(this._next())})),_createResult:u((function(t){return void 0===t?{done:!0,value:void 0}:{done:!1,value:this._resolve(t)}})),_resolve:u((function(t){return this.__list__[t]})),_unBind:u((function(){this.__list__=null,delete this.__redo__,this.__context__&&(this.__context__.off("_add",this._onAdd),this.__context__.off("_delete",this._onDelete),this.__context__.off("_clear",this._onClear),this.__context__=null)})),toString:u((function(){return"[object "+(this[l.toStringTag]||"Object")+"]"}))},a({_onAdd:u((function(t){t>=this.__nextIndex__||(++this.__nextIndex__,this.__redo__?(this.__redo__.forEach((function(e,r){e>=t&&(this.__redo__[r]=++e)}),this),this.__redo__.push(t)):p(this,"__redo__",u("c",[t])))})),_onDelete:u((function(t){var e;t>=this.__nextIndex__||(--this.__nextIndex__,this.__redo__&&(-1!==(e=this.__redo__.indexOf(t))&&this.__redo__.splice(e,1),this.__redo__.forEach((function(e,r){e>t&&(this.__redo__[r]=--e)}),this)))})),_onClear:u((function(){this.__redo__&&o.call(this.__redo__),this.__nextIndex__=0}))}))),p(n.prototype,l.iterator,u((function(){return this})))},858:function(t,e,r){"use strict";var n=r(1579);t.exports=function(t,e){var r;function o(n){e.rejectUnauthorized&&t.emit("error",n),r.end()}return e.port=e.port||8883,e.host=e.hostname||e.host||"localhost",e.rejectUnauthorized=!1!==e.rejectUnauthorized,delete e.path,(r=n.connect(e)).on("secureConnect",(function(){e.rejectUnauthorized&&!r.authorized?r.emit("error",new Error("TLS not authorized")):r.removeListener("error",o)})),r.on("error",o),r}}}]);